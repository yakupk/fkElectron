(this.webpackJsonpfaturakomkiosk=this.webpackJsonpfaturakomkiosk||[]).push([[17],{117:function(e,t,n){"use strict";n.r(t),n.d(t,"useEventListener",(function(){return N}));var r=n(4),i=n(24),a=n(15),c=n(0),u=n(13),s=n(5),o=n(16),l=n(33),d=n(282),j=n(283),b=n(285),f=n(60),O=n(71),p=n(105),m=n(107),v=n(25);var h=n(36);function y(e){return function(e){if(Array.isArray(e))return Object(v.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(h.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var x=n(31),g=n.n(x),k=(n(96),n(3)),A=function(e,t){return e.reduce((function(e,n,r){return r%t?e[e.length-1].push(n):e.push([n]),e}),[])};var _=function(e){var t=e.setFunc,n=e.left,r=void 0===n||n,i=e.right,a=void 0===i||i,c=A(y("ABCDEFGHIJKLMNOPRSTUVYZ"),8),u=A(Array(9).fill().map((function(e,t){return t+1})).concat(0,"C"),3);return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("div",{className:g()("keyboard",!r&&"disabled"),children:c.map((function(e,n){return Object(k.jsx)("div",{className:"keyboard-row",children:e.map((function(e){return Object(k.jsx)("button",{id:"character"+e,type:"button",className:g()("keyboard-button",e),onClick:function(){return t(e)},children:e},e)}))},n)}))}),Object(k.jsx)("div",{className:g()("keyboard","nums",!a&&"disabled"),children:u.map((function(e,n){return Object(k.jsx)("div",{className:"keyboard-row",children:e.map((function(e){return Object(k.jsx)("button",{id:"num"+e,type:"button",className:g()("keyboard-button",e),onClick:function(n){return t("numC"===n.target.id?"reset":e)},children:e},e)}))},n)}))})]})},w=n(34),E=n(17),S=n(82),T=n(97);function N(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window,r=Object(c.useRef)();Object(c.useEffect)((function(){r.current=t}),[t]),Object(c.useEffect)((function(){if(n&&n.addEventListener){var t=function(e){return r.current(e)};return n.addEventListener(e,t),function(){n.removeEventListener(e,t)}}}),[e,n])}t.default=function(e){var t,n,v=e.card,h=e.match,y=Object(u.c)(o.a).categories;console.log("data: ",{card:v});var x=Object(u.c)(l.a),g=x.loading,A=x.queryResult,I=x.hasErrors,M=x.redirect,F=x.reRequest,L=Object(u.c)(E.c).profile,q=Object(c.useState)(""),z=Object(a.a)(q,2),C=z[0],P=z[1],H=Object(c.useState)(""),B=Object(a.a)(H,2),R=B[0],J=B[1],Y=0;L.hasOwnProperty("result")&&""==L.errors&&null!==L.result.reseller.card_devices&&(Y=L.result.reseller.card_devices[0].id);var D=y.result.institution_categories.map((function(e){return e.institutions})).flat().find((function(e){return e.id==h.params.id}));D=null!==(t=D)&&void 0!==t?t:y.result.shortcuts.find((function(e){return e.id==h.params.id}));var G=Object(s.g)(),Q=Object(u.b)();if(Object(c.useLayoutEffect)((function(){return Q(Object(l.e)()),function(){Q(Object(l.e)())}}),[]),Object(c.useLayoutEffect)((function(){I&&d.a.warning({className:"kioksModal",icon:null,title:"HATA !",content:"L\xfctfen doldurulmas\u0131 gereken alanlar\u0131 kontrol ediniz",okText:"TAMAM"})}),[I]),Object(c.useEffect)((function(){if(A.hasOwnProperty("result")){var e;if(""!==A.result[0].error&&null===A.result[0].items)return ce("reset"),d.a.warning({className:"kioksModal",icon:null,title:"HATA !",content:null!==(e=A.result[0].error)&&void 0!==e?e:"Fatura Bulunumad\u0131 !",okText:"TAMAM"});var t={};t.field1=Y.toString(),t.institution_id=parseInt(h.params.id),""!==A.result[0].additional_field&&A.result[0].is_continue&&(t.field2=A.result[0].additional_field,P(A.result[0].additional_field),Q(Object(l.d)(t))),F&&""===A.result[0].error&&A.result[0].is_continue&&(t.field2=C,""!==R&&(t.field3=R,setTimeout(function(){Q(Object(l.d)(t))}.bind(undefined),1e3)))}}),[F,A]),M&&A.hasOwnProperty("result")){var K=A.result[0].institution.category_type;"invoice"===K&&G.push("/queryresult"),"prepaid_card"===K&&G.push("/queryresultpartialpayment")}var U=Object(c.useMemo)((function(){var e;return Array.isArray(null===(e=D)||void 0===e?void 0:e.inputs)?D.inputs:[]}),[D]),V=(Object(c.useMemo)((function(){return"prepaid_card"===D.category_type&&("card_on"===v?"on":"off")}),[D,v]),Object(c.useState)(1)),Z=Object(a.a)(V,2),W=Z[0],X=Z[1],$=Object(c.useState)({}),ee=Object(a.a)($,2),te=ee[0],ne=ee[1],re=U.some((function(e){return e.alphanumeric})),ie=[{label:"Y\xfcklemek \u0130stedi\u011finiz Tutar",max:4,min:1,name:"field3"}],ae=null!==(n=U[W-1])&&void 0!==n?n:ie[W-1];Object(c.useEffect)((function(){return ne(Array(Array.isArray(U)?U.length:0).fill().map((function(e,t){return t+1})).reduce((function(e,t){return Object(i.a)(Object(i.a)({},e),{},Object(r.a)({},t,""))}),{}))}),[U]),N("click",(function(){var e,t=document.getElementsByTagName("input");t.length&&(null===(e=t[W-1])||void 0===e||e.focus())}));var ce=Object(c.useCallback)((function(e){var t;if(void 0!==te&&0===Object.keys(te).length&&(te[1]=""),"reset"===e)return ne(Object(i.a)(Object(i.a)({},te),{},Object(r.a)({},W,"")));if("del"===e){var n=te[W];return n.length>0?ne(Object(i.a)(Object(i.a)({},te),{},Object(r.a)({},W,n.slice(0,-1)))):n}if(te[W]&&(null===(t=te[W])||void 0===t?void 0:t.length)>=(null===ae||void 0===ae?void 0:ae.max))return d.a.warning({className:"kioksModal",icon:null,title:"HATA !",content:"Yeterince uzun, daha fazla karakter ekleyemezsiniz ",okText:"TAMAM"});ne(Object(i.a)(Object(i.a)({},te),{},Object(r.a)({},W,te[W]+e)))}),[te,ae,W]);return D?!Object.values(D).length||g&&"prepaid_card"!==D.category_type?Object(k.jsx)(w.a,{}):g&&"prepaid_card"===D.category_type&&F?Object(k.jsx)(T.a,{text1:"Sorgulan\u0131yor..."}):L.result.reseller.pos_device_status?Object(k.jsxs)(f.j,{children:[Object(k.jsx)(f.s,{}),Object(k.jsxs)(f.m,{children:[Object(k.jsx)(f.A,{institution:!0,children:D.name}),Object(k.jsx)(k.Fragment,{children:re?Object(k.jsxs)(j.a,{children:[Object(k.jsx)(b.a,{span:24,children:Object(k.jsxs)(f.a,{children:[Object(k.jsx)(f.q,{src:D.logo}),Object(k.jsx)(f.b,{institution:!0,children:D.description}),Object(k.jsx)(p.a,{type:"big",num:te,inputs:U,activeInputIndex:W,setActiveInput:X}),Object(k.jsx)(f.e,{section:"query",children:"Sorgula"})]})}),Object(k.jsx)(b.a,{span:24,className:"alphanumeric",children:Object(k.jsx)(_,{setFunc:ce,left:!!U[W-1].alphanumeric})})]}):Object(k.jsxs)(j.a,{children:[Object(k.jsxs)(b.a,{span:17,children:[Object(k.jsx)(f.b,{institution:!0,children:D.description}),Object(k.jsx)(p.a,{num:te,inputs:null!==U&&(null===U||void 0===U?void 0:U.length)>0?U:ie,activeInputIndex:W,setActiveInput:X}),Object(k.jsx)(f.e,{section:"query",form:"QueryForm",onClick:function(e){return function(e){e.preventDefault();for(var t={},n=document.getElementById("QueryForm").elements,r=0;r<n.length;r++){var i=n.item(r);"text"===n.item(r).type&&(t[i.name]=i.value.toString())}t.institution_id=parseInt(h.params.id),"prepaid_card"===D.category_type&&(t.hasOwnProperty("field3")&&J(t.field3),t.field1=Y.toString()),Q(Object(l.d)(t))}(e)},children:"Sorgula"})]}),Object(k.jsxs)(b.a,{span:7,className:"numpad",children:[Object(k.jsx)(f.q,{src:D.logo}),Object(k.jsx)(m.a,{setFunc:ce})]})]})})]}),Object(k.jsx)(O.a,{children:Object(k.jsx)(f.e,{position:"left",onClick:function(){return G.push("/greeting")},children:"Geri"})})]}):Object(k.jsx)(S.default,{title:"Sistem Hatasi",message:"Pos cihazi \u015fuan i\xe7in devre d\u0131\u015f\u0131.L\xfctfen daha sonra tekrar deneyiniz."}):Object(k.jsx)(S.default,{})}},96:function(e,t,n){}}]);
//# sourceMappingURL=17.1f88b5a4.chunk.js.map